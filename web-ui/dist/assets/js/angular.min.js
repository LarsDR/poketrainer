angular.module("poketrainer",["poketrainer.Module.Templates","Poketrainer.Module.SocketEventEmitter","Poketrainer.Service.Navigation","Poketrainer.Service.SocketEvent","Poketrainer.Service.Socket","Poketrainer.State.Abstracts","Poketrainer.State.Status","Poketrainer.State.Users","ui.router","ngMaterial","ngMessages"]).config(["$urlRouterProvider","$locationProvider","$urlMatcherFactoryProvider","$mdThemingProvider",function(e,t,r,a){e.rule(function(e,t){var r=t.url().toLowerCase();if(!("/"===r[r.length-1]||r.indexOf("/?")>-1))return r.indexOf("?")>-1?r.replace("?","/?"):r+"/"}).otherwise("/"),r.strictMode(!1),a.theme("default").primaryPalette("blue").accentPalette("red")}]).run(["$state","$rootScope",function(e,t){t.$on("inventory:updated",function(e){})}]),angular.module("Poketrainer.Module.SocketEventEmitter",["Poketrainer.Service.Socket"]).run(["$rootScope","PokeSocket","SocketEvent",function(e,t,r){t.forward(r.UserStatus),t.on(r.Data,function(t){e.$broadcast(t.event+":"+t.action,t.data)})}]),angular.module("Poketrainer.State.Abstracts",["ui.router"]).config(["$stateProvider",function(e){e.state("public",{"abstract":!0,views:{header:{templateUrl:"states/abstracts/header.tpl.html",controller:"HeaderController"},content:{template:"<ui-view/>"}}})}]).controller("HeaderController",["$rootScope","$scope","$state","Navigation",function(e,t,r,a){t.navigation=a.primary.get(),t.state=r.current.name,e.$on("$stateChangeSuccess",function(e,r,a,n,o){t.state=r.name})}]),angular.module("Poketrainer.State.Status",["ui.router","uiGmapgoogle-maps","chart.js","easypiechart","datatables","ui-leaflet","nemLogging"]).config(["$stateProvider","uiGmapGoogleMapApiProvider",function(e,t){t.configure({v:"3.24",libraries:"weather,geometry,visualization"}),e.state("public.dashboard",{url:"/dashboard/:username",resolve:{locationData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"location"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["location"]}),n.promise}],inventoryData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"inventory"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["inventory"]}),n.promise}],playerData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"player"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["player"]}),n.promise}],playerStatsData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"player_stats"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["player_stats"]}),n.promise}],pokemonData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"pokemon"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["pokemon"]}),n.promise}],attacksData:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function(e){!angular.isUndefined(e)&&e.success&&"attacks"==e.type&&n.resolve(angular.fromJson(e.data))};return r.on(a.Request,o),r.emit(a.Request,{username:t.username,types:["attacks"]}),n.promise}]},controller:"DashboardController",templateUrl:"states/dashboard/dashboard.tpl.html"})}]).run(["Navigation",function(e){e.primary.register("Users","public.users",30,"md md-event-available","public.users")}]).controller("DashboardController",["$scope","$stateParams","$mdToast","PokeSocket","leafletData","locationData","inventoryData","playerData","playerStatsData","pokemonData","attacksData","SocketEvent","DTOptionsBuilder",function(e,t,r,a,n,o,s,i,l,u,c,p,m){a.emit(p.Join,{room:t.username});var d,f=function S(t){if(e.transfer_disabled=!1,t.success)for(var n=e.pokemon.length-1;n>=0;n--)e.pokemon[n].id==d&&e.pokemon.splice(n,1);d=0,a.removeListener(p.Transfer,S),r.show(r.simple().textContent(t.message).position("top center").hideDelay(1e3))};e.transfer_disabled=!1,e.transfer=function(r){d=r,e.transfer_disabled=!0,a.on(p.Transfer,f),a.emit(p.Transfer,{username:t.username,p_id:r})};var v=function y(t){e.snipe_disabled=!1,a.removeListener(p.Snipe,y),r.show(r.simple().textContent(t.message).position("top center").hideDelay(1e3))};e.snipe_coords="",e.snipe_disabled=!1,e.snipe_auto=!1,e.snipe=function(r){e.snipe_disabled=!0,a.on(p.Snipe,v),a.emit(p.Snipe,{username:t.username,latlng:r})},e.$on("inventory:updated",function(t,r){e.inventory=r,g()}),e.$on("player_stats:updated",function(t,r){e.playerStats=r,g()}),e.$on("player:updated",function(t,r){e.player=r,g()}),e.$on("pokemon:caught",function(t,a){var n=a;e.pokemon.push(n),g(),r.show(r.simple().textContent("Caught: "+n.name+" (IV: "+Math.floor(n.iv)+" | CP: "+n.cp+")").position("top center").hideDelay(3e3))}),e.$on("pokemon:released",function(t,a){for(var n=a,o=e.pokemon.length-1;o>=0;o--)e.pokemon[o].id==n.id&&e.pokemon.splice(o,1);g(),r.show(r.simple().textContent("Released: "+n.name+" (IV: "+Math.floor(n.iv)+" | CP: "+n.cp+")").position("top center").hideDelay(3e3))}),e.$on("fort:spun",function(e,t){r.show(r.simple().textContent("Fort spun, reward: "+t.reward).position("top center").hideDelay(3e3))});var k=0;e.$on("position:update",function(t,r){if(k++,k%5==0){e.markers.bot.lat=r[0],e.markers.bot.lng=r[1];var a={lat:r[0],lng:r[1]};e.paths.main.latlngs.push(a)}}),e.player=i,e.playerStats=l,e.inventory=s,e.pokemon=u,e.attacks=c;var g=function(){e.playerStats.xpPercent=Math.floor((e.playerStats.experience-e.playerStats.prev_level_xp)/(e.playerStats.next_level_xp-e.playerStats.prev_level_xp)*100),e.playerStats.uniquePokedexPercent=Math.floor(e.playerStats.unique_pokedex_entries/151*100),e.playerStats.pokemonInvPercent=Math.floor(e.pokemon.length/e.player.max_pokemon_storage*100),e.playerStats.itemsInvPercent=Math.floor(e.inventory.item_count/e.player.max_item_storage*100)};g(),e.$on("$viewContentLoaded",function(){n.getMap().then(function(e){setTimeout(function(){e.invalidateSize()},3e3)})}),e.map={center:{lat:o[0],lng:o[1],zoom:15}},e.markers={bot:{lat:o[0],lng:o[1],message:e.player.username,focus:!0,draggable:!1}},e.paths={main:{color:"#F44336",weight:4,latlngs:[{lat:o[0],lng:o[1]}]}},e.pokemonDataTableOptions=m.newOptions().withOption("order",[[0,"desc"]]),e.expLvlOptions={animate:{duration:1e3,enabled:!0},barColor:"#03A9F4",scaleColor:!1,lineWidth:10,lineCap:"circle"},e.uniquePokedexOptions={animate:{duration:1e3,enabled:!0},barColor:"#FFC107",scaleColor:!1,lineWidth:10,lineCap:"circle"},e.pokemonInvOptions={animate:{duration:1e3,enabled:!0},barColor:"#009688",scaleColor:!1,lineWidth:10,lineCap:"circle"},e.itemsInvOptions={animate:{duration:1e3,enabled:!0},barColor:"#F44336",scaleColor:!1,lineWidth:10,lineCap:"circle"}}]),angular.module("Poketrainer.State.Users",["ui.router"]).config(["$stateProvider",function(e){e.state("public.users",{url:"/",resolve:{Users:["$q","$stateParams","PokeSocket","SocketEvent",function(e,t,r,a){var n=e.defer(),o=function s(e){!angular.isUndefined(e)&&e.success&&angular.isArray(e.users)&&(r.removeListener(a.UserList,s),n.resolve(e.users))};return r.on(a.UserList,o),r.emit(a.UserList),n.promise}]},controller:"UsersController",templateUrl:"states/users/users.tpl.html"})}]).run(["Navigation",function(e){e.primary.register("Users","public.users",30,"md md-event-available","public.users")}]).controller("UsersController",["$scope","Users","PokeSocket","SocketEvent",function(e,t,r,a){e.users=t;var n=function(t,r){for(var a=0;a<e.users.length;a++)e.users[a].username==r.username&&(e.users[a].status=r.status)};e.$on(a._prefix+a.UserStatus,n)}]),angular.module("Poketrainer.Service.Navigation",[]).factory("Navigation",function(){var e=[],t=function(){return e.sort(function(e,t){var r=e.Priority-t.Priority;return 0===r?e.Label.localeCompare(t.Label):r})},r=function(t,r,a,n,o){"string"!=typeof n&&(n="md md-chevron-right"),"string"!=typeof o&&(o=r),("number"!=typeof a||a<0)&&(a=10),e.push({Label:t,State:r,ActiveState:o,Priority:a,Icon:n})};return{primary:{get:t,register:r}}}),angular.module("Poketrainer.Service.SocketEvent",[]).factory("SocketEvent",function(){return{_prefix:"socket:",UserList:"users",UserStatus:"user_status",Request:"pull",Data:"push",Join:"join",Transfer:"transfer",Snipe:"snipe"}}),angular.module("Poketrainer.Service.Socket",["btford.socket-io"]).factory("PokeSocket",["socketFactory","$location",function(e,t){var r=window.location.pathname.replace(/\/+$/g,"")+"/socket.io";return e({ioSocket:io.connect(window.location.protocol+"//"+window.location.host+"/poketrainer",{path:r})})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1vZHVsZXMvbW9kdWxlLlNvY2tldEV2ZW50RW1pdHRlci5qcyIsInN0YXRlcy9hYnN0cmFjdHMvc3RhdGUuYWJzdHJhY3RzLmpzIiwic3RhdGVzL2Rhc2hib2FyZC9zdGF0ZS5kYXNoYm9hcmQuanMiLCJzdGF0ZXMvdXNlcnMvc3RhdGUudXNlcnMuanMiLCJtb2R1bGVzL3NlcnZpY2VzL3NlcnZpY2UuTmF2aWdhdGlvbi5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkdXJsTWF0Y2hlckZhY3RvcnlQcm92aWRlciIsIiRtZFRoZW1pbmdQcm92aWRlciIsInJ1bGUiLCIkaW5qZWN0b3IiLCIkbG9jYXRpb24iLCJwYXRoIiwidXJsIiwidG9Mb3dlckNhc2UiLCJsZW5ndGgiLCJpbmRleE9mIiwicmVwbGFjZSIsIm90aGVyd2lzZSIsInN0cmljdE1vZGUiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsInJ1biIsIiRzdGF0ZSIsIiRyb290U2NvcGUiLCIkb24iLCJkYXRhIiwiUG9rZVNvY2tldCIsIlNvY2tldEV2ZW50IiwiZm9yd2FyZCIsIlVzZXJTdGF0dXMiLCJvbiIsIkRhdGEiLCIkYnJvYWRjYXN0IiwiZXZlbnQiLCJhY3Rpb24iLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwiYWJzdHJhY3QiLCJ2aWV3cyIsImhlYWRlciIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRlbnQiLCJ0ZW1wbGF0ZSIsIiRzY29wZSIsIk5hdmlnYXRpb24iLCJuYXZpZ2F0aW9uIiwicHJpbWFyeSIsImdldCIsImN1cnJlbnQiLCJuYW1lIiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsInVpR21hcEdvb2dsZU1hcEFwaVByb3ZpZGVyIiwiY29uZmlndXJlIiwidiIsImxpYnJhcmllcyIsInJlc29sdmUiLCJsb2NhdGlvbkRhdGEiLCIkcSIsIiRzdGF0ZVBhcmFtcyIsImQiLCJkZWZlciIsImxvY2F0aW9uRGF0YUNiIiwibWVzc2FnZSIsImlzVW5kZWZpbmVkIiwic3VjY2VzcyIsInR5cGUiLCJmcm9tSnNvbiIsIlJlcXVlc3QiLCJlbWl0IiwidXNlcm5hbWUiLCJ0eXBlcyIsInByb21pc2UiLCJpbnZlbnRvcnlEYXRhIiwiaW52ZW50b3J5RGF0YUNiIiwicGxheWVyRGF0YSIsInBsYXllckRhdGFDYiIsInBsYXllclN0YXRzRGF0YSIsInBsYXllclN0YXRzRGF0YUNiIiwicG9rZW1vbkRhdGEiLCJwb2tlbW9uRGF0YUNiIiwiYXR0YWNrc0RhdGEiLCJhdHRhY2tzRGF0YUNiIiwicmVnaXN0ZXIiLCIkbWRUb2FzdCIsImxlYWZsZXREYXRhIiwiRFRPcHRpb25zQnVpbGRlciIsIkpvaW4iLCJyb29tIiwidHJhbnNmZXJfcF9pZCIsInRyYW5zZmVyQ2IiLCJ0cmFuc2Zlcl9kaXNhYmxlZCIsImkiLCJwb2tlbW9uIiwiaWQiLCJzcGxpY2UiLCJyZW1vdmVMaXN0ZW5lciIsIlRyYW5zZmVyIiwic2hvdyIsInNpbXBsZSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJ0cmFuc2ZlciIsInBfaWQiLCJzbmlwZWRDYiIsInNuaXBlX2Rpc2FibGVkIiwiU25pcGUiLCJzbmlwZV9jb29yZHMiLCJzbmlwZV9hdXRvIiwic25pcGUiLCJsYXRsbmciLCJpbnZlbnRvcnkiLCJ1cGRhdGVQZXJjZW50YWdlcyIsInBsYXllclN0YXRzIiwicGxheWVyIiwicHVzaCIsIk1hdGgiLCJmbG9vciIsIml2IiwiY3AiLCJyZXdhcmQiLCJwb3NpdGlvblVwZGF0ZXMiLCJtYXJrZXJzIiwiYm90IiwibGF0IiwibG5nIiwibmV3TG9jYXRpb24iLCJwYXRocyIsIm1haW4iLCJsYXRsbmdzIiwiYXR0YWNrcyIsInhwUGVyY2VudCIsImV4cGVyaWVuY2UiLCJwcmV2X2xldmVsX3hwIiwibmV4dF9sZXZlbF94cCIsInVuaXF1ZVBva2VkZXhQZXJjZW50IiwidW5pcXVlX3Bva2VkZXhfZW50cmllcyIsInBva2Vtb25JbnZQZXJjZW50IiwibWF4X3Bva2Vtb25fc3RvcmFnZSIsIml0ZW1zSW52UGVyY2VudCIsIml0ZW1fY291bnQiLCJtYXhfaXRlbV9zdG9yYWdlIiwiZ2V0TWFwIiwidGhlbiIsIm1hcCIsInNldFRpbWVvdXQiLCJpbnZhbGlkYXRlU2l6ZSIsImNlbnRlciIsInpvb20iLCJmb2N1cyIsImRyYWdnYWJsZSIsImNvbG9yIiwid2VpZ2h0IiwicG9rZW1vbkRhdGFUYWJsZU9wdGlvbnMiLCJuZXdPcHRpb25zIiwid2l0aE9wdGlvbiIsImV4cEx2bE9wdGlvbnMiLCJhbmltYXRlIiwiZHVyYXRpb24iLCJlbmFibGVkIiwiYmFyQ29sb3IiLCJzY2FsZUNvbG9yIiwibGluZVdpZHRoIiwibGluZUNhcCIsInVuaXF1ZVBva2VkZXhPcHRpb25zIiwicG9rZW1vbkludk9wdGlvbnMiLCJpdGVtc0ludk9wdGlvbnMiLCJVc2VycyIsInVzZXJFdmVudENiIiwiaXNBcnJheSIsInVzZXJzIiwiVXNlckxpc3QiLCJ1c2VyRXZlbnRVcGRhdGUiLCJzdGF0dXMiLCJfcHJlZml4IiwiZmFjdG9yeSIsImhlYWRlck5hdiIsImdldFByaW1hcnlNZW51Iiwic29ydCIsImEiLCJiIiwicHJpb3JpdHkiLCJQcmlvcml0eSIsIkxhYmVsIiwibG9jYWxlQ29tcGFyZSIsInJlZ2lzdGVyUHJpbWFyeU1lbnUiLCJsYWJlbCIsImljb24iLCJhY3RpdmVTdGF0ZSIsIlN0YXRlIiwiQWN0aXZlU3RhdGUiLCJJY29uIiwic29ja2V0RmFjdG9yeSIsIndpbmRvdyIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJpb1NvY2tldCIsImlvIiwiY29ubmVjdCIsInByb3RvY29sIiwiaG9zdCJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsZUFDQSwrQkFDQSx3Q0FDQSxpQ0FDQSxrQ0FDQSw2QkFDQSw4QkFDQSwyQkFDQSww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TUFBQUMsY0FBQUosRUFBQUcsT0FFQUYsS0FHQUksRUFBQSxTQUFBQyxFQUFBMUosRUFBQXFKLEVBQUFNLEVBQUFDLEdBQ0EsZ0JBQUFELEtBQ0FBLEVBQUEsdUJBRUEsZ0JBQUFDLEtBQ0FBLEVBQUE1SixJQUVBLGdCQUFBcUosSUFBQUEsRUFBQSxLQUNBQSxFQUFBLElBRUFMLEVBQUE3RCxNQUNBb0UsTUFBQUcsRUFDQUcsTUFBQTdKLEVBQ0E4SixZQUFBRixFQUNBTixTQUFBRCxFQUNBVSxLQUFBSixJQ3ZEQSxRQUNBaEosU0FDQUMsSUFBQXFJLEVBQ0EvRixTQUFBdUcsTUFJQTdMLFFBQUFDLE9BQUEsc0NBQUFrTCxRQUFBLGNBQUEsV0FDQSxPQUNBRCxRQUFBLFVBQ0FILFNBQUEsUUFDQWxKLFdBQUEsY0FDQTBDLFFBQUEsT0FDQXhDLEtBQUEsT0FDQTJELEtBQUEsT0FDQVUsU0FBQSxXQUNBVSxNQUFBLFdBR0E5RyxRQUFBQyxPQUFBLDhCQUFBLHFCQUFBa0wsUUFBQSxjQUNBLGdCQUNBLFlBQ0EsU0FBQWlCLEVBQUEzTCxHQUNBLEdBQUFDLEdBQUEyTCxPQUFBQyxTQUFBQyxTQUFBeEwsUUFBQSxRQUFBLElBQUEsWUFFQSxPQUFBcUwsSUFBQUksU0FBQUMsR0FBQUMsUUFBQUwsT0FBQUMsU0FBQUssU0FBQSxLQUFBTixPQUFBQyxTQUFBTSxLQUFBLGdCQUFBbE0sS0FBQUEiLCJmaWxlIjoiYW5ndWxhci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgncG9rZXRyYWluZXInLCBbXHJcblx0J3Bva2V0cmFpbmVyLk1vZHVsZS5UZW1wbGF0ZXMnLFxyXG5cclxuXHQvKiogSW50ZXJuYWwgTW9kdWxlcyAqKi9cclxuXHQnUG9rZXRyYWluZXIuTW9kdWxlLlNvY2tldEV2ZW50RW1pdHRlcicsXHJcblxyXG5cdC8qKiBJbnRlcm5hbCBTZXJ2aWNlcyAqKi9cclxuXHQnUG9rZXRyYWluZXIuU2VydmljZS5OYXZpZ2F0aW9uJyxcclxuXHQnUG9rZXRyYWluZXIuU2VydmljZS5Tb2NrZXRFdmVudCcsXHJcblx0J1Bva2V0cmFpbmVyLlNlcnZpY2UuU29ja2V0JyxcclxuXHJcblx0LyoqIFN0YXRlcy9Sb3V0ZXMgKiovXHJcblx0J1Bva2V0cmFpbmVyLlN0YXRlLkFic3RyYWN0cycsXHJcblx0J1Bva2V0cmFpbmVyLlN0YXRlLlN0YXR1cycsXHJcblx0J1Bva2V0cmFpbmVyLlN0YXRlLlVzZXJzJyxcclxuXHJcblxyXG5cdC8qKiBFeHRlcm5hbCBMaWJzICoqL1xyXG5cdCd1aS5yb3V0ZXInLFxyXG4gICAgJ25nTWF0ZXJpYWwnLFxyXG4gICAgJ25nTWVzc2FnZXMnXHJcblxyXG5cdC8qKiBJbnRlcm5hbCBEaXJlY3RpdmVzICoqL1xyXG5cdFxyXG5dKVxyXG5cclxuXHQuY29uZmlnKGZ1bmN0aW9uIHBva2VUcmFpbmVyQ29uZmlnKCR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICR1cmxNYXRjaGVyRmFjdG9yeVByb3ZpZGVyLCAkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuXHRcdC8vJGxvY2F0aW9uUHJvdmlkZXJcclxuXHRcdC8vXHQuaGFzaFByZWZpeCgnIScpXHJcblx0XHQvL1x0Lmh0bWw1TW9kZShmYWxzZSk7XHJcblxyXG5cdFx0JHVybFJvdXRlclByb3ZpZGVyLnJ1bGUoZnVuY3Rpb24gKCRpbmplY3RvciwgJGxvY2F0aW9uKSB7XHJcblx0XHRcdHZhciBwYXRoID0gJGxvY2F0aW9uLnVybCgpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG5cdFx0XHQvLyBjaGVjayB0byBzZWUgaWYgdGhlIHBhdGggYWxyZWFkeSBoYXMgYSBzbGFzaCB3aGVyZSBpdCBzaG91bGQgYmVcclxuXHRcdFx0aWYgKHBhdGhbcGF0aC5sZW5ndGggLSAxXSA9PT0gJy8nIHx8IHBhdGguaW5kZXhPZignLz8nKSA+IC0xKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAocGF0aC5pbmRleE9mKCc/JykgPiAtMSkge1xyXG5cdFx0XHRcdHJldHVybiBwYXRoLnJlcGxhY2UoJz8nLCAnLz8nKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHBhdGggKyAnLyc7XHJcblx0XHR9KVxyXG5cdFx0Lm90aGVyd2lzZSgnLycpO1xyXG5cclxuXHRcdCR1cmxNYXRjaGVyRmFjdG9yeVByb3ZpZGVyLnN0cmljdE1vZGUoZmFsc2UpO1xyXG5cclxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2JsdWUnKVxyXG4gICAgICAgICAgICAuYWNjZW50UGFsZXR0ZSgncmVkJyk7XHJcblxyXG5cdH0pXHJcblxyXG5cdC5ydW4oZnVuY3Rpb24gcG9rZVRyYWluZXJSdW4gKCRzdGF0ZSwgJHJvb3RTY29wZSkge1xyXG5cdFx0JHJvb3RTY29wZS4kb24oJ2ludmVudG9yeTp1cGRhdGVkJywgZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdC8vY29uc29sZS5sb2coXCJJbnZlbnRvcnkhISA6RCBcIilcclxuXHRcdH0pXHJcblx0fSlcclxuXHJcbjsiLCJhbmd1bGFyLm1vZHVsZSgnUG9rZXRyYWluZXIuTW9kdWxlLlNvY2tldEV2ZW50RW1pdHRlcicsIFsnUG9rZXRyYWluZXIuU2VydmljZS5Tb2NrZXQnXSlcclxuICAgIC5ydW4oZnVuY3Rpb24gcnVuU29ja2V0RW1pdHRlcigkcm9vdFNjb3BlLCBQb2tlU29ja2V0LCBTb2NrZXRFdmVudCl7XHJcblxyXG4gICAgICAgIFBva2VTb2NrZXQuZm9yd2FyZChTb2NrZXRFdmVudC5Vc2VyU3RhdHVzKTtcclxuXHJcbiAgICAgICAgUG9rZVNvY2tldC5vbihTb2NrZXRFdmVudC5EYXRhLCBmdW5jdGlvbiBnZXRTb2NrZXRQdXNoKGRhdGEpe1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiR290IHB1c2ggZGF0YTogXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoZGF0YS5ldmVudCArIFwiOlwiICsgZGF0YS5hY3Rpb24sIGRhdGEuZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIEJyb2FkY2FzdCBldmVudHMgdXNpbmcgJHJvb3RTY29wZS4kYnJvYWRjYXN0KFtuYW1lXSwgW2RhdGFdKTtcclxuICAgIH0pXHJcblxyXG47IiwiYW5ndWxhci5tb2R1bGUoJ1Bva2V0cmFpbmVyLlN0YXRlLkFic3RyYWN0cycsIFtcclxuICAgICd1aS5yb3V0ZXInXHJcbl0pXHJcblxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbiBjb25maWcoJHN0YXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgICAgICAuc3RhdGUoJ3B1YmxpYycsIHtcclxuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBcImhlYWRlclwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnc3RhdGVzL2Fic3RyYWN0cy9oZWFkZXIudHBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSGVhZGVyQ29udHJvbGxlcidcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIFwiY29udGVudFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgO1xyXG4gICAgfSlcclxuXHJcbiAgICAuY29udHJvbGxlcignSGVhZGVyQ29udHJvbGxlcicsIGZ1bmN0aW9uIEhlYWRlckNvbnRyb2xsZXIoJHJvb3RTY29wZSwgJHNjb3BlLCAkc3RhdGUsIE5hdmlnYXRpb24pe1xyXG4gICAgICAgICRzY29wZS5uYXZpZ2F0aW9uID0gTmF2aWdhdGlvbi5wcmltYXJ5LmdldCgpO1xyXG4gICAgICAgICRzY29wZS5zdGF0ZSA9ICRzdGF0ZS5jdXJyZW50Lm5hbWU7XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zdGF0ZSA9IHRvU3RhdGUubmFtZTtcclxuICAgICAgICB9KTtcclxuICAgIH0pXHJcblxyXG47IiwiYW5ndWxhci5tb2R1bGUoJ1Bva2V0cmFpbmVyLlN0YXRlLlN0YXR1cycsIFtcclxuICAgICd1aS5yb3V0ZXInLFxyXG4gICAgJ3VpR21hcGdvb2dsZS1tYXBzJyxcclxuICAgICdjaGFydC5qcycsXHJcbiAgICAnZWFzeXBpZWNoYXJ0JyxcclxuICAgICdkYXRhdGFibGVzJyxcclxuICAgICd1aS1sZWFmbGV0JyxcclxuICAgICduZW1Mb2dnaW5nJ1xyXG5dKVxyXG5cclxuICAgIC5jb25maWcoZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyLCB1aUdtYXBHb29nbGVNYXBBcGlQcm92aWRlcikge1xyXG5cclxuICAgICAgICB1aUdtYXBHb29nbGVNYXBBcGlQcm92aWRlci5jb25maWd1cmUoe1xyXG4gICAgICAgICAgICAvL2tleTogJzxNQVBTIEFQSSBLRVk+JyxcclxuICAgICAgICAgICAgdjogJzMuMjQnLFxyXG4gICAgICAgICAgICBsaWJyYXJpZXM6ICd3ZWF0aGVyLGdlb21ldHJ5LHZpc3VhbGl6YXRpb24nXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdwdWJsaWMuZGFzaGJvYXJkJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkLzp1c2VybmFtZScsXHJcbiAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uRGF0YTogWyckcScsICckc3RhdGVQYXJhbXMnLCAnUG9rZVNvY2tldCcsICdTb2NrZXRFdmVudCcsIGZ1bmN0aW9uIHJlc29sdmVMb2NhdGlvbkRhdGEoJHEsICRzdGF0ZVBhcmFtcywgUG9rZVNvY2tldCwgU29ja2V0RXZlbnQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uRGF0YUNiID0gZnVuY3Rpb24gbG9jYXRpb25EYXRhQ2IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKG1lc3NhZ2UpIHx8ICFtZXNzYWdlLnN1Y2Nlc3MgfHwgbWVzc2FnZS50eXBlICE9ICdsb2NhdGlvbicpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShhbmd1bGFyLmZyb21Kc29uKG1lc3NhZ2UuZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFBva2VTb2NrZXQub24oU29ja2V0RXZlbnQuUmVxdWVzdCwgbG9jYXRpb25EYXRhQ2IpO1xyXG4gICAgICAgICAgICAgICAgICAgIFBva2VTb2NrZXQuZW1pdChTb2NrZXRFdmVudC5SZXF1ZXN0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkc3RhdGVQYXJhbXMudXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzOiBbJ2xvY2F0aW9uJ11cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgaW52ZW50b3J5RGF0YTogWyckcScsICckc3RhdGVQYXJhbXMnLCAnUG9rZVNvY2tldCcsICdTb2NrZXRFdmVudCcsIGZ1bmN0aW9uIHJlc29sdmVJbnZlbnRvcnlEYXRhKCRxLCAkc3RhdGVQYXJhbXMsIFBva2VTb2NrZXQsIFNvY2tldEV2ZW50KXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnZlbnRvcnlEYXRhQ2IgPSBmdW5jdGlvbiBpbnZlbnRvcnlEYXRhQ2IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKG1lc3NhZ2UpIHx8ICFtZXNzYWdlLnN1Y2Nlc3MgfHwgbWVzc2FnZS50eXBlICE9ICdpbnZlbnRvcnknKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoYW5ndWxhci5mcm9tSnNvbihtZXNzYWdlLmRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQb2tlU29ja2V0Lm9uKFNvY2tldEV2ZW50LlJlcXVlc3QsIGludmVudG9yeURhdGFDYik7XHJcbiAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LlJlcXVlc3QsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6ICRzdGF0ZVBhcmFtcy51c2VybmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXM6IFsnaW52ZW50b3J5J11cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgcGxheWVyRGF0YTogWyckcScsICckc3RhdGVQYXJhbXMnLCAnUG9rZVNvY2tldCcsICdTb2NrZXRFdmVudCcsIGZ1bmN0aW9uIHJlc29sdmVQbGF5ZXJEYXRhKCRxLCAkc3RhdGVQYXJhbXMsIFBva2VTb2NrZXQsIFNvY2tldEV2ZW50KXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGF5ZXJEYXRhQ2IgPSBmdW5jdGlvbiBwbGF5ZXJEYXRhQ2IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKG1lc3NhZ2UpIHx8ICFtZXNzYWdlLnN1Y2Nlc3MgfHwgbWVzc2FnZS50eXBlICE9ICdwbGF5ZXInKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoYW5ndWxhci5mcm9tSnNvbihtZXNzYWdlLmRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQb2tlU29ja2V0Lm9uKFNvY2tldEV2ZW50LlJlcXVlc3QsIHBsYXllckRhdGFDYik7XHJcbiAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LlJlcXVlc3QsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6ICRzdGF0ZVBhcmFtcy51c2VybmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXM6IFsncGxheWVyJ11cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgcGxheWVyU3RhdHNEYXRhOiBbJyRxJywgJyRzdGF0ZVBhcmFtcycsICdQb2tlU29ja2V0JywgJ1NvY2tldEV2ZW50JywgZnVuY3Rpb24gcmVzb2x2ZVBsYXllclN0YXRzRGF0YSgkcSwgJHN0YXRlUGFyYW1zLCBQb2tlU29ja2V0LCBTb2NrZXRFdmVudCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGxheWVyU3RhdHNEYXRhQ2IgPSBmdW5jdGlvbiBwbGF5ZXJTdGF0c0RhdGFDYihtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFuZ3VsYXIuaXNVbmRlZmluZWQobWVzc2FnZSkgfHwgIW1lc3NhZ2Uuc3VjY2VzcyB8fCBtZXNzYWdlLnR5cGUgIT0gJ3BsYXllcl9zdGF0cycpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZShhbmd1bGFyLmZyb21Kc29uKG1lc3NhZ2UuZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFBva2VTb2NrZXQub24oU29ja2V0RXZlbnQuUmVxdWVzdCwgcGxheWVyU3RhdHNEYXRhQ2IpO1xyXG4gICAgICAgICAgICAgICAgICAgIFBva2VTb2NrZXQuZW1pdChTb2NrZXRFdmVudC5SZXF1ZXN0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkc3RhdGVQYXJhbXMudXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzOiBbJ3BsYXllcl9zdGF0cyddXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XHJcbiAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgIHBva2Vtb25EYXRhOiBbJyRxJywgJyRzdGF0ZVBhcmFtcycsICdQb2tlU29ja2V0JywgJ1NvY2tldEV2ZW50JywgZnVuY3Rpb24gcmVzb2x2ZVBva2Vtb25EYXRhKCRxLCAkc3RhdGVQYXJhbXMsIFBva2VTb2NrZXQsIFNvY2tldEV2ZW50KXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwb2tlbW9uRGF0YUNiID0gZnVuY3Rpb24gcG9rZW1vbkRhdGFDYihtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFuZ3VsYXIuaXNVbmRlZmluZWQobWVzc2FnZSkgfHwgIW1lc3NhZ2Uuc3VjY2VzcyB8fCBtZXNzYWdlLnR5cGUgIT0gJ3Bva2Vtb24nKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoYW5ndWxhci5mcm9tSnNvbihtZXNzYWdlLmRhdGEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBQb2tlU29ja2V0Lm9uKFNvY2tldEV2ZW50LlJlcXVlc3QsIHBva2Vtb25EYXRhQ2IpO1xyXG4gICAgICAgICAgICAgICAgICAgIFBva2VTb2NrZXQuZW1pdChTb2NrZXRFdmVudC5SZXF1ZXN0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkc3RhdGVQYXJhbXMudXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzOiBbJ3Bva2Vtb24nXVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBhdHRhY2tzRGF0YTogWyckcScsICckc3RhdGVQYXJhbXMnLCAnUG9rZVNvY2tldCcsICdTb2NrZXRFdmVudCcsIGZ1bmN0aW9uIHJlc29sdmVBdHRhY2tzRGF0YSgkcSwgJHN0YXRlUGFyYW1zLCBQb2tlU29ja2V0LCBTb2NrZXRFdmVudCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXR0YWNrc0RhdGFDYiA9IGZ1bmN0aW9uIGF0dGFja3NEYXRhQ2IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKG1lc3NhZ2UpIHx8ICFtZXNzYWdlLnN1Y2Nlc3MgfHwgbWVzc2FnZS50eXBlICE9ICdhdHRhY2tzJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKGFuZ3VsYXIuZnJvbUpzb24obWVzc2FnZS5kYXRhKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5vbihTb2NrZXRFdmVudC5SZXF1ZXN0LCBhdHRhY2tzRGF0YUNiKTtcclxuICAgICAgICAgICAgICAgICAgICBQb2tlU29ja2V0LmVtaXQoU29ja2V0RXZlbnQuUmVxdWVzdCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogJHN0YXRlUGFyYW1zLnVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlczogWydhdHRhY2tzJ11cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdzdGF0ZXMvZGFzaGJvYXJkL2Rhc2hib2FyZC50cGwuaHRtbCdcclxuICAgICAgICB9KVxyXG4gICAgICAgIDtcclxuICAgIH0pXHJcblxyXG4gICAgLnJ1bihmdW5jdGlvbiAoTmF2aWdhdGlvbikge1xyXG4gICAgICAgIE5hdmlnYXRpb24ucHJpbWFyeS5yZWdpc3RlcihcIlVzZXJzXCIsIFwicHVibGljLnVzZXJzXCIsIDMwLCAnbWQgbWQtZXZlbnQtYXZhaWxhYmxlJywgJ3B1YmxpYy51c2VycycpO1xyXG4gICAgfSlcclxuXHJcbiAgICAuY29udHJvbGxlcignRGFzaGJvYXJkQ29udHJvbGxlcicsIGZ1bmN0aW9uIERhc2hib2FyZENvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGVQYXJhbXMsICRtZFRvYXN0LCBQb2tlU29ja2V0LCBsZWFmbGV0RGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkRhdGEsIGludmVudG9yeURhdGEsIHBsYXllckRhdGEsIHBsYXllclN0YXRzRGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2tlbW9uRGF0YSwgYXR0YWNrc0RhdGEsIFNvY2tldEV2ZW50LCBEVE9wdGlvbnNCdWlsZGVyKSB7XHJcblxyXG4gICAgICAgIC8vIEpvaW4gc3BlY2lmaWMgdXNlciByb29tXHJcbiAgICAgICAgLy8gVE9ETzogd2Ugc2hvdWxkIGxlYXZlIHRoZSByb29tIHdoZW4gd2UgY2hhbmdlIHRoZSBwYWdlXHJcbiAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LkpvaW4sIHtyb29tOiAkc3RhdGVQYXJhbXMudXNlcm5hbWV9KTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwiSm9pbmVkISBcIiwgU29ja2V0RXZlbnQuSm9pbiwgJHN0YXRlUGFyYW1zLnVzZXJuYW1lKTtcclxuXHJcbiAgICAgICAgdmFyIHRyYW5zZmVyX3BfaWQ7XHJcbiAgICAgICAgdmFyIHRyYW5zZmVyQ2IgPSBmdW5jdGlvbiB0cmFuc2ZlckNiKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgLy9tZXNzYWdlLnN1Y2Nlc3M7XHJcbiAgICAgICAgICAgICRzY29wZS50cmFuc2Zlcl9kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9JHNjb3BlLnBva2Vtb24ubGVuZ3RoLTE7IGk+PTA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucG9rZW1vbltpXS5pZCA9PSB0cmFuc2Zlcl9wX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wb2tlbW9uLnNwbGljZShpLDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0cmFuc2Zlcl9wX2lkID0gMDtcclxuICAgICAgICAgICAgUG9rZVNvY2tldC5yZW1vdmVMaXN0ZW5lcihTb2NrZXRFdmVudC5UcmFuc2ZlciwgdHJhbnNmZXJDYik7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChtZXNzYWdlLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKCd0b3AgY2VudGVyJylcclxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDEwMDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmZXJfZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmZXIgPSBmdW5jdGlvbihwX2lkKSB7XHJcbiAgICAgICAgICAgIHRyYW5zZmVyX3BfaWQgPSBwX2lkO1xyXG4gICAgICAgICAgICAkc2NvcGUudHJhbnNmZXJfZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBQb2tlU29ja2V0Lm9uKFNvY2tldEV2ZW50LlRyYW5zZmVyLCB0cmFuc2ZlckNiKTtcclxuICAgICAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LlRyYW5zZmVyLCB7dXNlcm5hbWU6ICRzdGF0ZVBhcmFtcy51c2VybmFtZSwgcF9pZDogcF9pZH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzbmlwZWRDYiA9IGZ1bmN0aW9uIHNuaXBlZENiKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgLy9tZXNzYWdlLnN1Y2Nlc3M7XHJcbiAgICAgICAgICAgICRzY29wZS5zbmlwZV9kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBQb2tlU29ja2V0LnJlbW92ZUxpc3RlbmVyKFNvY2tldEV2ZW50LlNuaXBlLCBzbmlwZWRDYik7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChtZXNzYWdlLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKCd0b3AgY2VudGVyJylcclxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDEwMDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc25pcGVfY29vcmRzID0gJyc7XHJcbiAgICAgICAgJHNjb3BlLnNuaXBlX2Rpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnNuaXBlX2F1dG8gPSBmYWxzZTsgLy8gbm90IGltcGxlbWVudGVkXHJcbiAgICAgICAgJHNjb3BlLnNuaXBlID0gZnVuY3Rpb24oc25pcGVfY29vcmRzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zbmlwZV9kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIFBva2VTb2NrZXQub24oU29ja2V0RXZlbnQuU25pcGUsIHNuaXBlZENiKTtcclxuICAgICAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LlNuaXBlLCB7dXNlcm5hbWU6ICRzdGF0ZVBhcmFtcy51c2VybmFtZSwgbGF0bG5nOiBzbmlwZV9jb29yZHN9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgICRzY29wZS4kb24oJ2ludmVudG9yeTp1cGRhdGVkJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHsgXHJcbiDCoCDCoCDCoCDCoCDCoCDCoCRzY29wZS5pbnZlbnRvcnkgPSBkYXRhO1xyXG4gICAgICAgICAgICB1cGRhdGVQZXJjZW50YWdlcygpO1xyXG4gwqAgwqAgwqAgwqB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigncGxheWVyX3N0YXRzOnVwZGF0ZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gwqAgwqAgwqAgwqAgwqAgwqAkc2NvcGUucGxheWVyU3RhdHMgPSBkYXRhO1xyXG4gICAgICAgICAgICB1cGRhdGVQZXJjZW50YWdlcygpO1xyXG4gwqAgwqAgwqAgwqB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigncGxheWVyOnVwZGF0ZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gwqAgwqAgwqAgwqAgwqAgwqAkc2NvcGUucGxheWVyID0gZGF0YTtcclxuICAgICAgICAgICAgdXBkYXRlUGVyY2VudGFnZXMoKTtcclxuIMKgIMKgIMKgIMKgfSk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMgbWFrZXMgdGhlIHBva2Vtb24gdGFibGUgZ28gY3JhenkgZm9yIGEgYml0XHJcbiAgICAgICAgLy8gd2UgaW5zZXJ0IC8gZGVsZXRlIGJhc2VkIG9uIG90aGVyIGV2ZW5zLCBzbyBpdCBfc2hvdWxkXyBiZSBhY2N1cmF0ZSBhbnl3YXlcclxuICAgICAgICAvKiRzY29wZS4kb24oJ2NhdWdodF9wb2tlbW9uOnVwZGF0ZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAkc2NvcGUucG9rZW1vbiA9IGRhdGE7XHJcbiDCoCDCoCDCoCDCoH0pOyovXHJcbiBcclxuICAgICAgICAkc2NvcGUuJG9uKCdwb2tlbW9uOmNhdWdodCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2tlbW9uID0gZGF0YTtcclxuICAgICAgICAgICAgLy9wb2tlbW9uLmNyZWF0aW9uX3RpbWVfbXMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuIMKgIMKgIMKgIMKgIMKgIMKgJHNjb3BlLnBva2Vtb24ucHVzaChwb2tlbW9uKTtcclxuICAgICAgICAgICAgdXBkYXRlUGVyY2VudGFnZXMoKTtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdDYXVnaHQ6ICcgKyBwb2tlbW9uLm5hbWUgKyAnIChJVjogJyArIE1hdGguZmxvb3IocG9rZW1vbi5pdikgKyAnIHwgQ1A6ICcgKyBwb2tlbW9uLmNwICsgJyknKVxyXG4gICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIGNlbnRlcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxyXG4gICAgICAgICAgICApO1xyXG4gwqAgwqAgwqAgwqB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigncG9rZW1vbjpyZWxlYXNlZCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2tlbW9uID0gZGF0YTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPSRzY29wZS5wb2tlbW9uLmxlbmd0aC0xOyBpPj0wOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucG9rZW1vbltpXS5pZCA9PSBwb2tlbW9uLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBva2Vtb24uc3BsaWNlKGksMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXBkYXRlUGVyY2VudGFnZXMoKTtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdSZWxlYXNlZDogJyArIHBva2Vtb24ubmFtZSArICcgKElWOiAnICsgTWF0aC5mbG9vcihwb2tlbW9uLml2KSArICcgfCBDUDogJyArIHBva2Vtb24uY3AgKyAnKScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKCd0b3AgY2VudGVyJylcclxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXHJcbiAgICAgICAgICAgICk7XHJcbiDCoCDCoCDCoCDCoH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdmb3J0OnNwdW4nLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcclxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0ZvcnQgc3B1biwgcmV3YXJkOiAnICsgZGF0YS5yZXdhcmQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKCd0b3AgY2VudGVyJylcclxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXHJcbiAgICAgICAgICAgICk7XHJcbiDCoCDCoCDCoCDCoH0pO1xyXG4gXHJcbiAgICAgICAgdmFyIHBvc2l0aW9uVXBkYXRlcyA9IDA7XHJcbiDCoCDCoCDCoCDCoCRzY29wZS4kb24oJ3Bvc2l0aW9uOnVwZGF0ZScsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiDCoCDCoCDCoCDCoCDCoCDCoHBvc2l0aW9uVXBkYXRlcysrO1xyXG4gwqAgwqAgwqAgwqAgwqAgwqBpZiAocG9zaXRpb25VcGRhdGVzICUgNSA9PSAwKSB7XHJcbiDCoCDCoCDCoCDCoCDCoCDCoCDCoCDCoCRzY29wZS5tYXJrZXJzLmJvdC5sYXQgPSBkYXRhWzBdO1xyXG4gwqAgwqAgwqAgwqAgwqAgwqAgwqAgwqAkc2NvcGUubWFya2Vycy5ib3QubG5nID0gZGF0YVsxXTtcclxuIMKgIMKgIMKgIMKgIMKgIMKgIMKgIMKgdmFyIG5ld0xvY2F0aW9uID0ge2xhdDogZGF0YVswXSwgbG5nOiBkYXRhWzFdfTtcclxuIMKgIMKgIMKgIMKgIMKgIMKgIMKgIMKgJHNjb3BlLnBhdGhzLm1haW4ubGF0bG5ncy5wdXNoKG5ld0xvY2F0aW9uKTtcclxuIMKgIMKgIMKgIMKgIMKgIMKgfVxyXG4gwqAgwqAgwqAgwqB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBsYXllciA9IHBsYXllckRhdGE7XHJcbiAgICAgICAgJHNjb3BlLnBsYXllclN0YXRzID0gcGxheWVyU3RhdHNEYXRhO1xyXG4gICAgICAgICRzY29wZS5pbnZlbnRvcnkgPSBpbnZlbnRvcnlEYXRhO1xyXG4gICAgICAgICRzY29wZS5wb2tlbW9uID0gcG9rZW1vbkRhdGE7XHJcbiAgICAgICAgJHNjb3BlLmF0dGFja3MgPSBhdHRhY2tzRGF0YTtcclxuXHJcbiAgICAgICAgdmFyIHVwZGF0ZVBlcmNlbnRhZ2VzID0gZnVuY3Rpb24gdXBkYXRlUGVyY2VudGFnZXMoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wbGF5ZXJTdGF0cy54cFBlcmNlbnQgPSBNYXRoLmZsb29yKFxyXG4gICAgICAgICAgICAgICAgKCRzY29wZS5wbGF5ZXJTdGF0cy5leHBlcmllbmNlIC0gJHNjb3BlLnBsYXllclN0YXRzLnByZXZfbGV2ZWxfeHApXHJcbiAgICAgICAgICAgICAgICAvKCRzY29wZS5wbGF5ZXJTdGF0cy5uZXh0X2xldmVsX3hwIC0gJHNjb3BlLnBsYXllclN0YXRzLnByZXZfbGV2ZWxfeHApXHJcbiAgICAgICAgICAgICAgICAqMTAwXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICRzY29wZS5wbGF5ZXJTdGF0cy51bmlxdWVQb2tlZGV4UGVyY2VudCA9IE1hdGguZmxvb3IoJHNjb3BlLnBsYXllclN0YXRzLnVuaXF1ZV9wb2tlZGV4X2VudHJpZXMgLyAxNTEgKiAxMDApO1xyXG4gICAgICAgICAgICAkc2NvcGUucGxheWVyU3RhdHMucG9rZW1vbkludlBlcmNlbnQgPSBNYXRoLmZsb29yKCRzY29wZS5wb2tlbW9uLmxlbmd0aCAvICRzY29wZS5wbGF5ZXIubWF4X3Bva2Vtb25fc3RvcmFnZSAgKiAxMDApO1xyXG4gICAgICAgICAgICAkc2NvcGUucGxheWVyU3RhdHMuaXRlbXNJbnZQZXJjZW50ID0gTWF0aC5mbG9vcigkc2NvcGUuaW52ZW50b3J5Lml0ZW1fY291bnQgLyAkc2NvcGUucGxheWVyLm1heF9pdGVtX3N0b3JhZ2UgICogMTAwKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHVwZGF0ZVBlcmNlbnRhZ2VzKCk7XHJcblxyXG4gICAgICAgIC8vIHZlcnkgZGlydHkgZml4IHRvIG1ha2UgdGhlIGxlYWZsZXQgbWFwIGxvYWQgZnVsbHNjcmVlblxyXG4gICAgICAgICRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsZWFmbGV0RGF0YS5nZXRNYXAoKS50aGVuKGZ1bmN0aW9uKG1hcCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpeyBtYXAuaW52YWxpZGF0ZVNpemUoKTsgfSwgMzAwMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRzY29wZS5tYXAgPSB7IGNlbnRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsb2NhdGlvbkRhdGFbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbmc6IGxvY2F0aW9uRGF0YVsxXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDE1XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAkc2NvcGUubWFya2VycyA9IHtcclxuICAgICAgICAgICAgYm90OiB7XHJcbiAgICAgICAgICAgICAgICBsYXQ6IGxvY2F0aW9uRGF0YVswXSxcclxuICAgICAgICAgICAgICAgIGxuZzogbG9jYXRpb25EYXRhWzFdLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJHNjb3BlLnBsYXllci51c2VybmFtZSxcclxuICAgICAgICAgICAgICAgIGZvY3VzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAkc2NvcGUucGF0aHMgPSB7XHJcbiAgICAgICAgICAgIG1haW46IHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnI0Y0NDMzNicsXHJcbiAgICAgICAgICAgICAgICB3ZWlnaHQ6IDQsXHJcbiAgICAgICAgICAgICAgICBsYXRsbmdzOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgeyBsYXQ6IGxvY2F0aW9uRGF0YVswXSwgbG5nOiBsb2NhdGlvbkRhdGFbMV0gfVxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAkc2NvcGUucG9rZW1vbkRhdGFUYWJsZU9wdGlvbnMgPSBEVE9wdGlvbnNCdWlsZGVyLm5ld09wdGlvbnMoKVxyXG4gICAgICAgICAgICAud2l0aE9wdGlvbignb3JkZXInLCBbWyAwLCBcImRlc2NcIiBdXSk7XHJcbiAgICAgICAgICAgIC8qLndpdGhPcHRpb24oJ3BhZ2luZycsIHRydWUpXHJcbiAgICAgICAgICAgIC53aXRoT3B0aW9uKCdzY3JvbGxZJywgJzc1dmgnKVxyXG4gICAgICAgICAgICAud2l0aE9wdGlvbignc2Nyb2xsWCcsIHRydWUpOyovXHJcblxyXG4gICAgICAgICRzY29wZS5leHBMdmxPcHRpb25zID0ge1xyXG4gICAgICAgICAgICBhbmltYXRlOntcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOnRydWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYmFyQ29sb3I6JyMwM0E5RjQnLFxyXG4gICAgICAgICAgICBzY2FsZUNvbG9yOmZhbHNlLFxyXG4gICAgICAgICAgICBsaW5lV2lkdGg6MTAsXHJcbiAgICAgICAgICAgIGxpbmVDYXA6J2NpcmNsZSdcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUudW5pcXVlUG9rZWRleE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGFuaW1hdGU6e1xyXG4gICAgICAgICAgICAgICAgZHVyYXRpb246MTAwMCxcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6dHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBiYXJDb2xvcjonI0ZGQzEwNycsXHJcbiAgICAgICAgICAgIHNjYWxlQ29sb3I6ZmFsc2UsXHJcbiAgICAgICAgICAgIGxpbmVXaWR0aDoxMCxcclxuICAgICAgICAgICAgbGluZUNhcDonY2lyY2xlJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5wb2tlbW9uSW52T3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgYW5pbWF0ZTp7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjoxMDAwLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJhckNvbG9yOicjMDA5Njg4JyxcclxuICAgICAgICAgICAgc2NhbGVDb2xvcjpmYWxzZSxcclxuICAgICAgICAgICAgbGluZVdpZHRoOjEwLFxyXG4gICAgICAgICAgICBsaW5lQ2FwOidjaXJjbGUnXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLml0ZW1zSW52T3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgYW5pbWF0ZTp7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjoxMDAwLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDp0cnVlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJhckNvbG9yOicjRjQ0MzM2JyxcclxuICAgICAgICAgICAgc2NhbGVDb2xvcjpmYWxzZSxcclxuICAgICAgICAgICAgbGluZVdpZHRoOjEwLFxyXG4gICAgICAgICAgICBsaW5lQ2FwOidjaXJjbGUnXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuXHJcbiAgICB9KVxyXG47XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdQb2tldHJhaW5lci5TdGF0ZS5Vc2VycycsIFtcclxuICAgICd1aS5yb3V0ZXInXHJcbl0pXHJcblxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbiBjb25maWcoJHN0YXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgncHVibGljLnVzZXJzJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgVXNlcnM6IFsnJHEnLCAnJHN0YXRlUGFyYW1zJywgJ1Bva2VTb2NrZXQnLCAnU29ja2V0RXZlbnQnLCBmdW5jdGlvbiByZXNvbHZlVXNlcnMoJHEsICRzdGF0ZVBhcmFtcywgUG9rZVNvY2tldCwgU29ja2V0RXZlbnQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJFdmVudENiID0gZnVuY3Rpb24gdXNlckV2ZW50Q2IobWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKG1lc3NhZ2UpIHx8ICFtZXNzYWdlLnN1Y2Nlc3MgfHwgIWFuZ3VsYXIuaXNBcnJheShtZXNzYWdlLnVzZXJzKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5yZW1vdmVMaXN0ZW5lcihTb2NrZXRFdmVudC5Vc2VyTGlzdCwgdXNlckV2ZW50Q2IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUobWVzc2FnZS51c2Vycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5vbihTb2NrZXRFdmVudC5Vc2VyTGlzdCwgdXNlckV2ZW50Q2IpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBFbWl0IHRoZSBldmVudCB0byBvdXIgc29ja2V0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWZ0ZXIgbGlzdGVuaW5nIGZvciBpdC5cclxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIHNpbmNlIHdlIGNvbm5lY3QgYW55d2F5LCBhbnkgaXNzdWVzP1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIGVuZWQgaXQgdG8gZ2V0IGJhY2sgdG8gdGhlIGJvdHMtb3ZlcnZpZXc/XHJcbiAgICAgICAgICAgICAgICAgICAgUG9rZVNvY2tldC5lbWl0KFNvY2tldEV2ZW50LlVzZXJMaXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdVc2Vyc0NvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3N0YXRlcy91c2Vycy91c2Vycy50cGwuaHRtbCdcclxuICAgICAgICB9KVxyXG4gICAgICAgIDtcclxuICAgIH0pXHJcblxyXG4gICAgLnJ1bihmdW5jdGlvbiAoTmF2aWdhdGlvbikge1xyXG4gICAgICAgIE5hdmlnYXRpb24ucHJpbWFyeS5yZWdpc3RlcihcIlVzZXJzXCIsIFwicHVibGljLnVzZXJzXCIsIDMwLCAnbWQgbWQtZXZlbnQtYXZhaWxhYmxlJywgJ3B1YmxpYy51c2VycycpO1xyXG4gICAgfSlcclxuXHJcbiAgICAuY29udHJvbGxlcignVXNlcnNDb250cm9sbGVyJywgZnVuY3Rpb24gVXNlcnNDb250cm9sbGVyKCRzY29wZSwgVXNlcnMsIFBva2VTb2NrZXQsIFNvY2tldEV2ZW50KSB7XHJcbiAgICAgICAgLy8gd2UgZG9uJ3QgbmVlZCBhbnkgZGF0YSBmcm9tIHRoZSBnbG9iYWwgc2NvcGUgaGVyZS4uLiB5ZXQ/XHJcbiAgICAgICAgLy9Qb2tlU29ja2V0LmVtaXQoU29ja2V0RXZlbnQuSm9pbiwge3Jvb206ICdnbG9iYWwnfSk7XHJcbiAgICAgICAgJHNjb3BlLnVzZXJzID0gVXNlcnM7XHJcblxyXG4gICAgICAgIHZhciB1c2VyRXZlbnRVcGRhdGUgPSBmdW5jdGlvbiB1c2VyRXZlbnRVcGRhdGUoZXZlbnQsIG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUudXNlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudXNlcnNbaV0udXNlcm5hbWUgPT0gbWVzc2FnZS51c2VybmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2Vyc1tpXS5zdGF0dXMgPSBtZXNzYWdlLnN0YXR1cztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0byBsaXN0ZW4gZm9yIG5ldyBldmVudHNcclxuICAgICAgICAkc2NvcGUuJG9uKFNvY2tldEV2ZW50Ll9wcmVmaXggKyBTb2NrZXRFdmVudC5Vc2VyU3RhdHVzLCB1c2VyRXZlbnRVcGRhdGUpO1xyXG4gICAgfSlcclxuO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnUG9rZXRyYWluZXIuU2VydmljZS5OYXZpZ2F0aW9uJywgW10pXHJcblxyXG4gICAgLmZhY3RvcnkoJ05hdmlnYXRpb24nLCBmdW5jdGlvbiBOYXZpZ2F0aW9uRmFjdG9yeSgpIHtcclxuICAgICAgICB2YXIgaGVhZGVyTmF2ID0gW107XHJcblxyXG4gICAgICAgIHZhciBnZXRQcmltYXJ5TWVudSA9IGZ1bmN0aW9uIGdldFByaW1hcnlNZW51KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyTmF2LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwcmlvcml0eSA9IGEuUHJpb3JpdHkgLSBiLlByaW9yaXR5O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwcmlvcml0eSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLkxhYmVsLmxvY2FsZUNvbXBhcmUoYi5MYWJlbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByaW9yaXR5O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciByZWdpc3RlclByaW1hcnlNZW51ID0gZnVuY3Rpb24gcmVnaXN0ZXJQcmltYXJ5TWVudShsYWJlbCwgc3RhdGUsIHByaW9yaXR5LCBpY29uLCBhY3RpdmVTdGF0ZSkge1xyXG4gICAgICAgICAgICBpZiggdHlwZW9mKGljb24pICE9PSBcInN0cmluZ1wiKXtcclxuICAgICAgICAgICAgICAgIGljb24gPSBcIm1kIG1kLWNoZXZyb24tcmlnaHRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiggdHlwZW9mKGFjdGl2ZVN0YXRlKSAhPT0gXCJzdHJpbmdcIil7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVTdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIChwcmlvcml0eSkgIT09IFwibnVtYmVyXCIgfHwgcHJpb3JpdHkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eSA9IDEwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoZWFkZXJOYXYucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBMYWJlbDogbGFiZWwsXHJcbiAgICAgICAgICAgICAgICBTdGF0ZTogc3RhdGUsXHJcbiAgICAgICAgICAgICAgICBBY3RpdmVTdGF0ZTogYWN0aXZlU3RhdGUsXHJcbiAgICAgICAgICAgICAgICBQcmlvcml0eTogcHJpb3JpdHksXHJcbiAgICAgICAgICAgICAgICBJY29uOiBpY29uXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHByaW1hcnk6IHtcclxuICAgICAgICAgICAgICAgIGdldDogZ2V0UHJpbWFyeU1lbnUsXHJcbiAgICAgICAgICAgICAgICByZWdpc3RlcjogcmVnaXN0ZXJQcmltYXJ5TWVudVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
